cleanup: cleanup.sh
difficulty: medium
expect:
- contains: (?i)allowed-csistoragecapacity-2
script:
- prompt: |
    You are reviewing Kubernetes resources for policy compliance.

    ## Policy Rule
    Verifies deprecated Kubernetes APIs to ensure all the API versions are up to date. This template does not apply to audit as audit looks at the resources which are already present in the cluster with non-deprecated API versions.

    ## Policy Parameters
    ```yaml
    k8sVersion: 1.27
    kvs:
    - deprecatedAPI: storage.k8s.io/v1beta1
      kinds:
      - CSIStorageCapacity
      targetAPI: storage.k8s.io/v1
    ```

    ## Applicable Resource Types
    This policy applies to: CSIStorageCapacity

    ## Resources to Review
    Below are the Kubernetes resource definitions to analyze:

    ```yaml
    apiVersion: storage.k8s.io/v1
    kind: CSIStorageCapacity
    metadata:
      name: allowed-csistoragecapacity
    storageClassName: standard
    ---
    apiVersion: storage.k8s.io/v1beta1
    kind: CSIStorageCapacity
    metadata:
      name: allowed-csistoragecapacity-2
      namespace: default
    storageClassName: standard

    ```

    ## Task
    Review the resources above and identify which ones violate the policy.

    List each violating resource in the format: `Kind/Name` with a brief explanation of why it violates the policy.
    If a resource is compliant, you do not need to list it.
setup: setup.sh
